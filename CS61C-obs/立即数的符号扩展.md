
1. **出现符号扩展的情况 
- 在一些位操作（如移位指令`srli`, `slli`）中，立即数作为无符号值使用，并不会进行符号扩展
- 其他所有情况下，risc-v指令中的立即数都需要从12位（若为I、S、B型指令）或20位（若为J、U型指令）扩展到32位

2. **典型——`lui`与`addi`连用的情况**
当lui指令与addi指令组合使用时，由于addi指令的立即数是符号扩展的，可能会导致`高20位“-1”`的问题。以下是一个例子：

```assembly
`lui x1, 0x12345      # x1 = 0x12345000 
addi x1, x1, 0xFFF    # x1 = 0x12345000 + 0xFFFFFFFFFFFFF7FF = 0x12344FFF
```

在这个例子中：

- `lui`指令将`x1`设为`0x12345000`。
- `addi`指令的立即数`0xFFF`被符号扩展为`0xFFFFFFFFFFFFF7FF`（即-1），然后与`x1`相加，导致最终结果是`0x12344FFF`，而不是预期的`0x12345000 + 0xFFF = 0x12345FFF`。

3. **解决方法：**
为了避免符号扩展导致的这种问题，在使用`addi`时应确保立即数不会被错误地符号扩展。通常的做法是将低12位立即数分解为非负数，确保`addi`操作不会引入符号扩展问题。例如，避免直接使用0xFFF，而是通过提前调整`lui`加载的高位来实现正确的数值加法。


 